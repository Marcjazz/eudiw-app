name: Compile and Deploy

on:
  push:
    branches:
      - main  # Replace 'main' with your main branch name or any other branch name you want to trigger this workflow

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Install dependencies
      run: |
        npm install  # Replace this with your dependency installation command

    - name: Build
      run: |
        npm run build  # Replace this with your build command

    - name: Commit build artifacts
      run: |
        git config --local user.email "actions@github.com"
        git config --local user.name "GitHub Actions"
        git checkout -b deploy-branch
        git add .
        git commit -m "Deploy build artifacts"
        git push origin deploy-branch

# jobs:
#   build:
#     # Recommended if you intend to make multiple deployments in quick succession.
#     concurrency: ci-${{ github.ref }}
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout ðŸ›Žï¸
#         uses: actions/checkout@v4
#         # This example project is built using npm and outputs the result to the 'build' folder.
#         # Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.
#       - name: Install and Build ðŸ”§
#         run: |
#           npm ci
#           npx nx run wallet-react:build --baseHref=/eudiw-app-dev/

#       - name: Setup Pages ðŸ“„ðŸ”§
#         id: pages
#         uses: actions/configure-pages@v4
#       - name: Upload artifact
#         uses: actions/upload-pages-artifact@v3
#         with:
#           path: ./dist/apps/wallet-react
#   deploy:
#     environment:
#       name: github-pages
#       url: ${{ steps.deployment.outputs.page_url }}
#     runs-on: ubuntu-latest
#     needs: build
#     steps:
#       - name: Set deployment directory
#         id: set-deploy-dir
#         run: echo "deploy_dir=${{ github.ref_slug }}" >> $GITHUB_ENV
#       - name: Deploy to Github Pages ðŸš€
#         id: deployment
#         uses: actions/deploy-pages@v4
#         with:
#             branch: ${{ env.deploy_dir }}
#             folder: dist/apps/wallet-react
